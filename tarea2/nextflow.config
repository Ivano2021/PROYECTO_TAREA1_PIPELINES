/*
 * Perfiles de ejecución:
 * - local  : sin contenedores
 * - docker : usa ubuntu:22.04
 */

profiles {

  local {
    process.executor = 'local'
    docker.enabled   = false
  }

  docker {
    process.executor  = 'local'
    docker.enabled    = true
    process.container = 'ubuntu:22.04'
    // PATH dentro del contenedor (opcional)
    env.PATH = '/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'
  }
}

/* Salidas de monitoreo y trazas */
timeline {
  enabled = true
  file = "${launchDir}/results/timeline.html"
}

report {
  enabled = true
  file = "${launchDir}/results/report.html"
}

trace {
  enabled = true
  file = "${launchDir}/results/trace.txt"
  // Agregamos la columna 'container' para verificar que usó Docker
  fields = 'task_id,hash,native_id,name,status,exit,submit,duration,realtime,%cpu,peak_rss,peak_vmem,rchar,wchar,container'
}

dag {
  enabled = true
  // Si tenés graphviz instaldo, podés cambiar .dot por .png
  file = "${launchDir}/results/flowchart.dot"
}

